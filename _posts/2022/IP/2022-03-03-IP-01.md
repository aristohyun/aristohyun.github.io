---
layout: post
title: "IP, 1장 컴퓨터 비전과 영상처리"
description: "영상처리, 최경주교수님"
categories: [ImageProcessing]
tags: [2022-1, Image Processing, IP, 최경주]
use_math: true
redirect_from:
  - /IP/1
  - /blog/IP/1
---

* Kramdown table of contents
{:toc .toc} 


# 컴퓨터비전(Computer Vision)과 영상처리(Image Processing)란?

## Preview

### 영상처리

> The Manipulation and Analysis of Pictorial Information            
> Pictorial Information의 조작 및 분석

- 디지털 영상을 다루는 학문
- 많은 응용에서 사용되는 넓은 영역의 기술을 총칭
- Goal : human interpretation, machine perception
- Operation : improve, correct, analyze and change (an image)
  - 공간정보를 입력받아서 픽셀(공간도메인)로 들어온걸 다른 도메인(주파수도메인등)으로 출력할수있음
- Image correction : optical processing
  - 사람이 렌즈를 통해서 개선한듯 컴퓨터도 가능

### 컴퓨터 비전(Computer Vision)

> 컴퓨터를 이용하여 시각 기능을 갖는 기계 장치를 만드는 기술 분야

투시된 영상들로부터 주어진 장면에 관한 유용한 정보를 추출하여 물리적인 대상을 명확하고 의미있게 기술하도록 하는 과정

## 왜 컴퓨터 비전인가?

1950~60년대 : 사람의 시각에 필적하는 컴퓨터 비전 시스템을 만들려는 목표가 대세

현재 : 특수한 환경(제약조건)에서 임무를 수행하는 시스템을 구현하는 실용적인 목표로 전환

특정 용도로 사용하려고 하다보니 응용방법이 넘쳐나고 있음.

- 산업, 오락, 교통, 보안, 계산 사진학, 의료, 군사, 과학, 농업, 모바일 등 각분야에 특화된 기술 개발

# 컴퓨터비전 또는 영상처리 문제는 어떻게 해결하나?

> 컴퓨터로 `사람 수준`을 달성하는 목표는 현재 기술로 `불가능`

## 과학적 접근과 공학적 접근

### 접근 1. 사람의 시각에 맞먹는 인공 시각을 만든다

> 어떠한 영상이 입력되더라도 내용을 분석하고 해석하고 이해한 후 그 결과를 출력해
야 함. (제약이 없는 상황)

`과학적 접근`

- 필연적으로 사람 시각의 원리를 밝혀낸 다음 컴퓨터로 모방
- 뇌 과학(brain science)의 주요 관심사
- 2가지 어려움
  - 인간의 시각 과정을 완전히 밝혀낼 수 있나? 그것을 컴퓨터로 시뮬레이션 할 수 있나?
  - 현재로서는 불가능
- 지식 표현, 학습, 추론, 창작 같은 인공 지능 문제가 모두 풀려야 가능

#### 문제점

- 역 문제(inverse problem)
  - 2차원 영상으로부터 역으로 3차원 세계를 찾는 것이 어려움
- 불량 문제(ill-posed problem)
  - 문제의 답이 유일하지 않다
  - 영역 분할 문제 등
- 다양한 변형이 동시에 발생
  - 기하학적 변환, 광도 변환, 광학적 잡음 등 정보 변형이 이루어짐

### 접근 2. 한정된 범위에서 특정한 임무를 달성하는 인공 시각을 만든다

> 여러 제약이 있는 상황     
> 특정 상황에서 특정 임무를 수행하는 실용 시스템 구축

`공학적 접근`

특정 응용 상황을 염두에 두고, 상황에 맞는 높은 성능의 알고리즘을 확보하려 노력

#### 문제점

- 여전히 역 문제, 불량 문제, 다양한 변환이 복합적으로 발생
- 영상은 숫자로 구성된 2차원 배열 형태


## 컴퓨터 비전의 전형적인 처리 과정

<img width="600" alt="image" src="https://user-images.githubusercontent.com/32366711/159123552-244fa4eb-ffcc-41e8-87aa-815885cf3308.png">

### 전처리, preprocessing
- 카메라로 획득한 원래 영상을 입력 받아 사용목적에 맞게 적절하게 처리하여 보다 개선된 영상으로 만들어 주는 과정
- 예) 잡음 개선, 초점이 흐린 영상 개선 등

### 특징추출, feature extraction
- 엣지, 선분, 원, 코너, 텍스처 등의 특징을 추출하는 단계

### 해석, analysis

`이해, 인식`

- 응용에 따라 다양한 형태
- 다양한 성능 향상 방법
  - 응용 현장에서 수집한 지식을 담은 지식베이스 사용
  - 많은 샘플영상을 수집하여 DB를 구성한 다음, 분류기 학습
  - 문맥 정보를 이용하는 후처리 단계 추가. 아직 걸음마 단계
    - 문맥을 제대로 활용하려면 지식 표현(knowledge representation)과 추론(inference)이라는 인공 지능문제를 해결해야 함
    - 의미문맥, 공간문맥, 자세문맥


## ex. 자동 어류 분류 시스템

전처리단계 : 명암 조절, 노이즈 제거, 영역 분할

**비용**, 결정경계를 어떻게 조절할 것인가

고기의 길이만을 특징으로 분류하면, 분류율이 최대 60프로

<img width="417" alt="image" src="https://user-images.githubusercontent.com/32366711/159123617-8a2275ca-114f-4711-ab10-9e9be3e10de6.png">

고기의 평균 명암 스케일만을 특징으로 분류하면, 

<img width="424" alt="image" src="https://user-images.githubusercontent.com/32366711/159123622-342b45f6-b77d-43dc-a46e-077a786e8a4d.png">

둘을 결합하여 사용하면, 분류율이 95.7%

<img width="325" alt="image" src="https://user-images.githubusercontent.com/32366711/159123632-7a9b688c-21c8-4957-9569-c4f895c8657e.png">

그렇다면 여기서 결정경계를 어디로 해야할까?

연어를 농어로 잘못 분류할 때의 비용과 농어를 연어로 잘못 분류할 때의 비용을 모두 최소로 할 방법


어떤 경우가 비용이 더 낮은지를 찾아 결정경계를 조절해야함



## 문제 해결 도구

- 자료 구조와 알고리즘
  - 데이터 표현, 고속수행을 위한 알고리즘
- 수학
  - 선형 대수, 미적분학, 확률, 통계 -> 최적해 찾기
- 기계 학습



# 시스템 설계

## 문제 이해

> 주어진 문제에 대한 직관적이고 철저한 이해 중요

## 데이터베이스 수집

데이터베이스 수집이 중요

다양한 데이터로 테스트를 해서 알고리즘의 성능을 검증해야하기 때문

## 알고리즘 설계와 구현

> 새로운 알고리즘 개발 혹은 기존 알고리즘 중에 주어진 문제에 적합한 것을 선택

## 성능 평가

- 문제 및 요구사항에 따라 성능 측정 방법이 다양하며, 위험 기준에 따라 시스템을 설계해야 한다.
- 혼동 행렬을 이용한 성능 분석

<img width="420" alt="image" src="https://user-images.githubusercontent.com/32366711/159124234-e26b3d7f-10b3-48bd-83ca-d9bc1391534c.png">

이외에 다양한 성능 평가 방식이 있음


# 인접 학문

## 영상처리

> 영상을 입력으로 받아 처리하여 새로운 영상을 출력

- 새로운 영상은 주어진 목적을 달성하는데 더 적합한 형태
- Gonzalez 저자의 Digital Image Processing 책 참조

## 컴퓨터 비전

> 영상을 입력받아, 분석 및 해석하여 고급묘사 출력

- 응용 분야에 따라 묘사의 종류는 다양
- 영상감시 : 이상 징후 여부
- 로봇 비전 : 장애물의 3차원 위치

## 컴퓨터 그래픽스

> 입력된 고급 묘사를 바탕으로 영상을 생성하거나 합성

- 컴퓨터 비전과 반대과정이라 생각할 수 있으나,
- 모호한(거친) 묘사(=예. 멀리뛰기 하는 여자 선수)가 주어졌을 때 자동으로 영상을 생성하는 지능적인 컴퓨터는 없음.
- 장면에 나타나는 모든 물체에 대해 물체를 구성하는 평면 및 연결관계를 지정해야 하며, 물체 표면의 반사 특성, 광
원의 위치, 조도까지도 하나하나 모두 설정해 주어야 함.

## 패턴 인식

> 온갖 종류의 데이터를 패턴으로 간주하고 분석과 분류 작업 수행

- 패턴 인식 연구의 핵심은 특징 추출기와 분류기의 성능을 높이려는 노력
- 공학적 접근법을 이용하여 인공지능의 실제 구현 문제인 감지된 대상을 인식하는 문제를 주로 다룸.
- 계산이 가능한 기계적인 장치(컴퓨터)가 어떠한 대상을 인식하는 문제를 다루는 인공지능의 한 분야
