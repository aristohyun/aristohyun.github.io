---
layout: post
title: "IP, 8장 모폴로지(형태적) 기법"
description: "영상처리, 최경주교수님"
categories: [ImageProcessing]
tags: [2022-1, Image Processing, IP, 최경주]
use_math: true
redirect_from:
  - /IP/8
  - /blog/IP/8
---

* Kramdown table of contents
{:toc .toc} 


# 모폴로지(Morphology) 기법

> 모폴로지 기법이란, 영상의 형태를 분석하고 처리하는 기법

- 원하는 부분만 추출 : 형태를 이미 알고있는 부분만 가능
- 영상내에서 관심 외의 물체는 노이즈 성분일뿐

# 이진 모폴로지 연산

형태소란[^SE], 어떤 모양을 표현하는 것으로 이진 영상으로 표현 가능한 임의의 크기와 구조가 될 수 있음. 마스크같은거
흑점 : 형태소의 원점, 중심

> 이진 영상에서는 밝기값에 형태소 행렬과 연산을 수행하여 출력 화소를 결정한다

- 침식 $A\ominus B$ : 감소
- 팽창 $A\oplus B$ : 증가
- 열림 $A \circ B$ : 팽창 후 침식
- 닫힘 $A \bullet B$ : 침식 후 팽창

이미지 27

[^SE]: structuring elements, SE, 구조요소

## 침식, Erosion

@
A\ominus B = \bigcap_{b \in B}^{} A_ b
@

이미지 6
p9 이미지

> 같은 형태소에 침식을 반복해서 적용하면 객체를 완전하게 제거할 수 있다

- 물체의 크기를 줄이고, 배경은 확대
- 물체와 배경 사이의 잡음을 제거 가능
- 영상에서의 돌출부는 감소시키고, 내부 돌출부는 증가시켜서 서로 닿은 물체를 분리할 때도 유용함

## 팽창, Dilation

@
A\oplus B = \bigcup_{w \in B}^{} A_ w
@

이미지 13

- 교환 법칙과 결합법칙 모두 성립. 즉 팽창의 순서는 상관없음
- 물체의 크기를 확장하고 배경은 축소
- 외부 돌출부 증가, 내부 돌출부 감소 => 객체 내부 잡음 제거


## 열림, Opening

@
A \circ B = (A \ominus B) \oplus B
@

침식 후 팽창

외곽선 부분을 더욱 부드럽게 하려면 열림연산을 반복해서 적용하여 침식연산을
특정 횟수만큼 반복한 뒤 팽창연산도 같은 횟수만큼 반복

- 돌출부와 좁은 연결부위를 제거
- 형태소보다 작은 크기의 밝은 객체를 제거


## 닫힘, Closing

@
A \bullet B = (A \oplus B) \ominus B
@

팽창 후 침식

- 내부 빈공간을 매꾸는 역할
- 형태소보다 작은 크기의 어두운 객체 제거

## 경계 추출

> 팽창과 침식을 이용해 경계를 검출할 수 있다

- 내부 경계 = A - A침식
- 외부 경계 = A팽창 - A
- 형태학적 기울기 = 내부경계 + 외부경계 = A팽창 - A침식

# 명암도 모폴로지 연산

> 물체의 밝기와 팽창의 밝기 간에 격차가 클 때는 명암도 영상의 침식과 팽창 연산이 효과적이다

- 침식 연산 : 배경을 강조
- 팽창 연산 : 객체를 강조
- 열림 연산 : 배경 중심 처리
- 닫히 연산 : 객체 중심 처리

## 침식

> 밝은 객체를 더 어둡게 보이도록 하여 축소하는 효과

@O(x,y) = min(\text{입력 화소 밝기와 마스크 화소의 각 합})@

- 밝기가 균일하지 않은 영역에서 효과적으로 처리 가능
- 255에 가까운 값으로 형태소 마스크를 구성할수록 침식 효과가 분명하게 나타남

## 팽창

> 객체를 더 밝게 하여 객체를 크게 보이게 하는 효과

@O(x,y) = max(\text{입력 화소 밝기와 마스크 화소의 각 합})@

- 255에 가까운 값으로 형태소 마스크를 구성할수록 팽창 효과가 분명하게 나타남

## 열림

> 밝은 특징들의 밝기가 감소

어두운 특징 및 배경은 상대적으로 영향을 받지 않음

## 닫힘

> 어두운 특징들의 밝기가 증가

- 밝은 디테일과 배경은 상대적으로 영향을 받지 않음

# 형태학적 스무딩 연산

`morphological smoothing`

> 열림 연산 후 닫힘 연산 수행          
> 영상 스무딩과 노이즈 제거용 형태학 필터로 사용

- 열림 연산 : 밝은 디테일 감소  
- 닫힘 연산 : 어두운 디테일 감소

# 형태학적 기울기 연산

`morphological gradient`

> 팽청 연산 - 침식 연산

(A \oplus B) - (A \ominus B )

# Top-hat, Bottom-hat

> 특정 물체를 추출하기 위한 모폴로지 기법 중 하나

`적용할 형태소는 추출할 물체보다 더 크게 선택해야 함`

비균일한 조명에서 보정 효과가 있음

#### Top-hat 변환

$T_ {hat}(f) = f - (f \circ b)$

- 원 영상 - 열림 연산 결과
- 어두운 배경의 밝은 개체

#### Bottom-hat 변환

$B_ {hat}(f) = (f \bullet b) - f$

- 닫힘 연산 결과 - 원 영상
- 밝은 배경의 어두운 개체


## 이진화

원 영상에서 Ostu이진화 등을 하면, 전역적으로 이진화 하며, 비균일 조명에서 취약하다

Top-hat 변환 결과 영상에 Otsu 이진화를 하면, 배경이 균형있게 만들어지기에 성공적인 이진화가 가능하다

- Top-hat 변환은 배경 영상의 추출을 위해 사용됨
- 반지름의 크기가 40인 디스크 모양의 형태소를 사용하여 열림 연산을 하면 쌀알들이 거의 제거되고 배경만 비슷하게 남음
- 이 영상을 원래 영상에서 빼면, 밝은 극값과 어두운 극값 간의 차이가 줄어듬 (완벽X)

이미지 50, 51 배경 변환 전후

## 텍스쳐 분할

> 분할(segmentation), 영상을 부 영역들로 나누는 프로세스

1. 작은 얼룩 제거 : 작은 얼룩의 크기보다 충분히 큰 크기의 형태소로 닫힘 연산 수행
2. 얼룩 간의 밝은 패치 제거 : 얼룩 간격보다 큰 형태소 적용
3. 형태학적 기울기 연산으로 경계 추출

이미지 52