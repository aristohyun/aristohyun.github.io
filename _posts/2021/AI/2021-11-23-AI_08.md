---
layout: post
title: "AI, 8장 지능로봇"
description: "AI, 이건명 교수님"
categories: [MachineLearning]
tags: [2021-2, AI, 이건명]
use_math: true
redirect_from:
  - /AI/08
  - /blog/AI/08
---

* Kramdown table of contents
{:toc .toc}  

# 로봇

> 사람이 하는 걷기, 말하기와 같은 다양하고 복잡한 행동을 하는 사람처럼 보이는 기계

> 자동으로 혹은 컴퓨터 제어에 따라 사름의 일을 할 수 있는 기계

> 다양한 작업을 위해 프로그램된 동작들을 통해서 자재, 부품, 도구, 장치 등을 움직이도록 설계된 재프로그래밍이 가능한(reprogrammable) 다기능 조작기(manipulator)

## 용도와 분류

### 용도

- 3D[^3D] 작업의 대체
- 인간 작업의 개선
  - 사람이 하는 것보다 잘 할 수 있는 분야에 적용
  - 구난 로봇, 감시 로봇  
- 인간 보조
  - 노인 보조, 간병, 재활, 수술 
- 오락
  - 장난감, 휴머노이드, 교육

[^3D]: Dirty, Dangerus, Demanding

### 분류

#### 용도에 따른 분류

- 산업용 로봇
  - 생산 라인에서 반복적인 정해진 작업을 수행
  - 로봇팔, 매니퓰레이터
  - Baxtor
- 서비스 로봇
  - 협업
  - 서비스 환경에 대한 인식과 환경에 따른 적응적인 동작을 해야 하기 때문에 인공지능 기술이 필요


#### 사용 환경에 따른 분류

- 무인 지상 로봇
- 무인 비행체
- 무인 수중 로봇

## 로봇 기술의 분야

- 위치추정(localization) 
  - 로봇의 현재 위치를 결정하기 위한 기술
- 센서 처리/인식/결합 (sensor processing/perception/fusion)
  - 로봇의 현재 상태 및 주변상황을 판단하기 위해 센서 데이터를 처리하여 해석하는 기술
- 불확실성 관리 (uncertainty management)
  - 잡음과 오류가 있는 센서 측정값의 처리 방법
- 센서 결합 (sensor fusion)
  - 현재 상태에 대한 추정치를 개선하기 위해 여러 센서의 데이터를 결합하는 기술
- 환경 모델링 (environment modeling)
  - 로봇의 주변 환경에 대한 가정 설정 및 표현 기술
- 관심 집중 (focus-of-attention)
  - 로봇이 집중해야 하는 대상의 설정 및 추적 기술
- 제어 구조 (control architecture)
  - 충분히 빠르게 로봇이 반응할 수 있도록 하는 제어 전략 및 구현 기술
- 추론 및 작업 조정 (reasoning and task arbitration)
  - 상황에 대한 추론 및 해야 할 작업 등에 대한 의사결정 기술
- 경로 계획 및 항법 (path planning and navigation) 
  - 로봇의 목적지 및 이동 경로 결정 기술
- 행동 선택 (action selection)
  -  취할 수 있는 행동이 여러 개 있을 때, 바람직한 행동 선택 기술
- 학습 및 적응 (learning and adaptation)
  - 동적으로 변하는 환경에 대응하도록 로봇의 동작 특성 및 지식이 변하도록 학습하는 기술
- 은닉상태 모델링 (hidden state modeling) 
  - 동일한 행동이지만 이전의 행동과는 다른 결과가 나오는 환경에는 관측되지 않은 은닉상태(hidden state)가 있기 때문에, 은닉상태를 고려하여 로봇의 동작 특성을 모델링하는 기술
- 다중 로봇 협업 및 통신(multi-robot cooperation and communication)
  -  여러 로봇이 있는 환경에서 다른 로봇들과 함께 일을 하도록 조정하는 기술 및 정보를 주고받는 기술

# 로봇 시스템의 구성

> 로봇의 목적에 맞는 행동을 할 수 있도록 여러 요소들(components)이 상호작용하는 관계(relationship)로 통합되어 있는 것

시스템, 컴포넌트들이 유기적으로 상호작용하는 것

## 물리적 구성요소

#### 기구적 구성요소

각종 기계 및 기구 부품

- 프레임(뼈대, frame)
- 하우징(housing) : 외관 또는 다른 장치를 지지하는 구조물
- 링크(link) : 강체로 되어 있는 부분
- 관절(joint) : 링크를 연결하는 부분
- 베어링(bearing)
- 기어(gear)
- 타이밍 벨트(timing belt) 
- 바퀴(wheel)

#### 하드웨어적 구성요소

전기, 전자적으로 작동하는 요소

- 구동기(actuator) : 힘을 전달하여 움직이게 하는 장치
- 센서(sensor) : 로봇의 내부 상태, 작업 대상, 외부 환경 정보 수집
- 제어기(controller) : 구동기, 센서 등에 연결되어 제어하는 장치
- SBC(Single Board Computer) : 라즈베리 파이와 같은 작은 컴퓨터
- 컴퓨터 본체

## 소프트웨어적 구성요소

- 운영체제
  - SBC 등의 컴퓨터에 대한 자원관리
- 제어기(controller) 펌웨어
  - 모터, 센서 등 각종 장치를 제어하는 MCU(micro-controller unit)에 탑재되는 소프트웨어
  - 받은 요청에 따라 해당 장치를 제어하고 처리

- 미들웨어(middleware) 
  - (다른 운영체제 또는 다른 프로그램 언어로 개발된 분산 환경에서) 소프트웨어 컴포넌트나 응용 프로그램이 쉽게 통신할 수 있도록 하는 소프트웨어
  - 일반적으로 라이브러리 형태
  - 미들웨어와 각종 개발도구들이 함께 개발 프레임워크(framework)로 제공

- 과업(task) 수행을 위한 각종 응용프로그램

#### 응용 소프트웨어 모듈

- 센서데이터로부터 자신 및 주변 상황을 인식하는 모듈
- 자신 및 주변 상황을 추론하는 모듈
- 특정 임무의 달성을 위한 계획 수립 모듈
  - 경로 계획(path planning), 로봇 팔의 매니퓰레이션(manipulation) 
- 계획에 따른 제어 모듈
  - 주행, 항법
- 동시적 위치추정 및 지도작성(SLAM)
  - 로봇 청소기 
- 현재 상황에서 가장 바람직한 행동 선택을 하는 모듈
- 다른 로봇 또는 사람과 의사소통하는 모듈
  - 음성인식, 얼굴인식, 제스처 인식, 대화 인식
- 학습 모듈


# 기구학과 동력학

## 기구학, kinematics

> 로봇의 관절이나 바퀴의 회전과 로봇의 변형이나 움직임을 결정하는데 사용되는 이론

#### 매니퓰레이터의 기구학

역기구학, inverse kinematics

#### 차분 구동방식

 특정 위치로 직접 이동할 수 없는 경우들이 많음

## 동력학, Dynamics

> 링크와 같은 강체를 움직이는 힘과 운동, 속도를 해석하는 분야



# 센서와 구동기

> 기기의 내·외부 조건 및 상황을 계측하기 위해 사용되는 장치

- 내부 센서 : 로봇의 동작을 위해 필수적인 상태 값 측정
- 외부 센서 : 로봇의 동작 환경과 작업 대상체에 대한 정보 수집

## 내부 센서

> 자기 위치 측정       
> 로봇의 동작을 위해 필수적인 상태 값 측정

- 엔코더(encoder) 
  - 회전/각도 량을 측정
- GPS
  - 4개의 GPS 위성에서 보내는 신호를 수신해 사용자의 현재 위치를 계산하는 방법
  - 시각, 위도, 경도, 고도 정보 제공
- 자이로스코프[^Gyroscope]
  - 회전하는 축(axis)은 외력에 저항하며 현재 상태 유지 성질
  - 자이로스코프에서 생성된 신호를 이용해 항공기 등의 자세 확인 가능
  - MEMS[^MEMS] (Micro Electro Mechanical Systems) 자이로스코프 출시
- 가속도 센서
  - 선형 가속도와 기울임 각도 측정
- 지자기 센서
  - 지구 자기장을 측정하는 센서
  - 직교하는 전도체 내의 전류와 자기장에 의해 전자가 편향되면서 도체 양단에 전압이 발생하는 원리를 이용
- 관성측정 장치(IMU, Inertial Measurement Unit) 
  - 이동관성을 측정하는 <blue>가속도계</blue>
  - 회전관성을 측정하는 <blue>자이로계</blue> 
  - 선택적으로 방위각을 측정하는 <blue>자계</blue>를 <red>하나로 통합한 장치</red>
  - 가속도와 각속도를 적분하여 이동거리 산출 가능
- 자세 방향 기준 장치(AHRS, Attitude Heading Reference System) 
  - 가속도계의 가속도, 자이로스코프의 각속도, 지자기계의 방향 정보 이용
  - 3차원 공간상의 자세(attitude)와 방위각(heading)에 대한 정보 출력


[^Gyroscope]: 자이로스코프는 짐발(Gimbal, 수평 유지 장치)에 놓이게 되므로 외부의 토크는 최소화되며, 장착된 짐발이 움직이더라도 회전축 방향은 거의 고정
[^MEMS]: 3축 각속도 측정, 각속도를 적분하여 각도 계산

## 외부 센서

> 외부 환경 감지
> 로봇의 동작 환경과 작업 대상체에 대한 정보 수집

- 적외선 거리 센서
  - 발광부에서 발생된 적외선이 물체에 부딪혀 반사된 빛을 수광부에서 감지하여, 물체의 유무와 거리 등을 측정
  - 아날로그 방식의 거리측정 센서
- 초음파 센서
  - 사람의 귀로 들을 수 없는 20KHz 이상의 초음파 사용
  - 가까운 거리에 있는 물체, 사람의 유무, 거리측정 등에 사용
- 레이더 (RADAR, Radio Detection And Ranging)
  - 라디오(Radio)파를 사용하여 물체의 범위, 고도, 방향, 속도 측정
  - 라디오파의 비행시간(time of flight, ToF)를 측정하여 거리 계산
- 라이다 (LIADR/LADAR)
  - 빛 또는 레이저를 쏴서 물체와의 거리를 측정하는 기술
  - 비행시간(ToF)를 측정하여 거리 계산
  - 대상의 방향, 속도, 온도, 물질의 농도 등의 특성 파악 가능
- 소나(Sound Navigation and Ranging, SONAR)
  - 음파에 의해 수중 목표의 방위 및 거리를 알아내는 장치
  - 능동 소나(active sonar)
    - 압력파인 음파를 발생시켜서 반사되어 돌아오는 음파의 전파 시간을 측정 하여 거리를 측정
  - 수동 소나(passive sonar)
    - 음파를 발생시키지 않고, 외부에서 발생한 음파를 수신하여 다른 잠수함이나 함선 등을 찾아내는 소나


- 비전 센서(영상 카메라)
  - RGB 카메라
  - RGBD 카메라 : 색상정보 + 깊이정보 제공
- 움직임 감지 센서(motion sensor)
  - 외부 대상의 움직임이나 로봇 자체의 움직임을 측정하는 센서
  - 적외선 센서, 초음파 센서, 가속도 센서 등
- 마이크로폰(microphone)
  - 외부 환경의 소리를 받아들이는 역할
- 스마트 센서(smart sensor)
  - 센싱 + 신호 처리 + 통신 기능
  - 마이크로프로세서를 내장하고 있어서 자체적인 처리 능력이 있는 센서
  - 측정된 신호의 아날로그-디지털(DA)변환, 잡음 제거, 데이터 압축 등의 처리후 결과를 통신 네트워크 인터페이스를 통해서 제공
- 토크(torque) 센서

#### 깊이 센서

- 비행시간 방식(TOF)
  - 발광에서 반사광의 감지까지 걸린 시간을 통해 거리 측정
- 구조광 방식(structured light)
  - 특정 패턴의 광을 주사하여, 패턴의 축소 및 왜곡을 측정하여 거리측정

## 구동기

> 로봇의 관절이나 바퀴 등에 제어 신호에 따라 <red>물리적인 움직임</red>을 주는 장치

- 전기식 (모터)
  - DC 모터 : 전원을 연결하면 전원이 끊길 때까지 회전
  - 서보(servo) 모터 : 모터 축의 위치에 대한 제어 신호를 받으면 해당 위치로 이동하여 상태 유지
  - 스테퍼(stepper) 모터: 인가하는 펄스 수에 비례하여 회전
  - 리니어 모터(linear motor) : 직선 운동을 하는 모터
  - 고출력, 고정밀도 가능, 비용 문제
- 유압식 (hydraulic) 
  - 유압 실린더, 유압 모터
  - 고출력 가능; 누유 문제
- 공압식 (pneumatic) 
  - 공기압 실린더, 공기압 모터가
  - 소형시스템, 정밀도; 속도 문제

## 제어

> 로봇이 특정 임무를 수행하기 위해서는 관절, 바퀴, 단말 조작자의 모터를 어떤 순서와 간격에 따라 가속, 정속, 또는 감속하는 조작 필요

- 궤적 생성(trajectory generation)
  - 임무를 수행하기 위해 미리 위치와 시간에 따른 궤적 생성
- 제어(control) 
  - 생성된 궤적을 따라가도록 계산된 조작을 하더라도 환경적 요인 때문에 기대한 대로 동작하지 않을 수 있음
    - 기계적 정밀도의 한계, 오작동, 미끄러짐 등
  - 시스템이 동작할 때, 목표와 실제 값의 차이를 보정(補正)하여 목표한 대로 만드는 것

### 제어 방식

- 개루프 제어(open loop control)
  - 위치 궤적 및 속도 정보에 대한 제어 프로파일을 미리 계산한 다음, 로봇 팔 등의 모터를 동작시키는 방식
  - 중간에 목표 값과 차이가 있어도 보정을 하지 않음
- 폐루프 제어(closed loop control, 되먹임 제어; feedback control)
  - 현재 상태 정보를 센서를 통해 입력받아서 목표와 현재 상태의 차이, 
  - 즉 오차를 줄이도록 지속해서 제어입력 결정


# 요소간의 통신 방식

UART(Universal Asynchronous Receiver Transmitter) 
- GND(기준전압), TX(송신선), RX(수신선) 등의 통신선 이용한 직렬통신
  - 병렬 데이터 ↔ 직렬 데이터 변환
  - UART 기능은 보통 MCU 등에 내장
- 비동기 방식이기 때문에, 미리 송/수신쪽에서 전송 속도 설정
- TTL level 전압 사용(5/3.3V, 0V) 
- 디지털 신호를 직접 전달
- 근거리 통신에 사용
  - 동일한 보드 상의 MCU간의 통신 등
  - 장거리 통신에 부적

RS-232/422/485
- TTL level 전압으로 통신하는 UART 통신을 보완한 방식
- 12V/-12V 또는 25V/-25V 전압으로 신호 전송
  - UART보다 먼거리까지 통신 가능
- TTL level 신호 ↔ RS-232 level 신호 변화 장치 사용
  - MAX232 칩 사용
- 사용하기 편리하나, 전송속도가 느리고, 전송 거리도 짧음
  - RS-232는 1:1 통신 지원
  - RS-422는 1:n 통신 지원
  - RS-485는 n:n 통신 지원

SPI / I2C 
- SPI (Serial Peripheral Interface)
- I2C (Inter-Integrated Circuit) 
- 근거리 통신 규격
- 1:n 통신 지원
  - 동일한 보드 내의 MCU간 연결, MCU와 센서 연결
  - MCU가 master가 되고, 센서들이 slave가 됨

USB (Universal Serial Bus) 
- 다양한 병렬, 직렬 방식의 기기 연결 지원
- 물리계층 규약과 프로토콜을 포함한 규격
  - USB 통신을 하기 위해서는 해당 디바이스 드라이버(device driver) 필요
  - KINECT 등의 카메라, 스마트기기 등이 USB 지원
- UART 통신 모듈을 USB로 연결 가능
  - 변환 모듈 사용 : FT232 
  - USB를 통해 Serial Port 생성 : 별도 디바이스 드라이버 설치

소프트웨어 요소 간의 통신
- 프로세스간의 통신(Inter-Process Communication, IPC) 이용
- 공유 메모리(shared memory) 사용
  - 같은 메모리 공간에 대한 접근
  - 동일 컴퓨터 내에서만 가능
- 소켓(socket) 통신
  - IP 주소(IP address)와 포트 번호(port number)로 식별되는 통신 단말(endpoint) 제공
  - 클라이언트-서버(client-server) 구조 사용


# 로봇 제어 패러다임과 구조

> 감지(sense), 계획(plan), 행동(act) 기능의 구성 방식에 따라 구별

- 감지 기능
  - 센서를 통해 정보를 수집하고 다른 기능 모듈에 전달
- 계획 기능
  - 정보를 받아들여 로봇이 수행할 단일 작업 또는 일련의 작업 생성
- 행동 기능
  - 모터 제어기 등에 출력 명령을 전달하여 행동을 수행하도록 하는 것

로봇 제어 구조
- 제어 시스템을 구성하는 원칙적인 방법 및 제약조건 명세
- 특정 패러다임을 따르는 참조모델


## 계층형 패러다임

> 감지하고, 계획을 수립하고, 이를 바탕으로 행동을 하는 과정의 반복

- NHC 구조 : 중첩 계층 제어기
- RCS 구조 : NIST 실시간 제어 시스템

<img width="600" alt="image" src="https://user-images.githubusercontent.com/32366711/144772619-c6be1114-c527-4661-9632-d25b02f6daef.png">

## 반응형 패러다임

> 계획수립을 하는 단계가 없이 센서를 통해 감지된 상황별로 바로 어떤 행동을 할지 대응

- 로봇 제어 프로그램을 병렬적인 행위들의 집합으로 구성
- 로봇 행동에 대한 별도의 지식을 표현하지 않고, 상황별로 수행할 행동만을 지정


로봇 행동에 대한 별도의 지식을 표현하지 않고, 상황별로 수행할 행동만을 지정

<img width="600" alt="image" src="https://user-images.githubusercontent.com/32366711/144772640-02af00cb-0d36-401c-9978-dea0961bc866.png">

중재자
- 두 가지 이상의 행위가 실행 가능하면서 충돌이 생기면 실행할 행동 결정
- 중재 전략
  - 경쟁적 방식 : 우선순위 부여 또는 다수결 투표
  - 협력적 방식 : 실행 가능한 두 개 이상의 동작을 동시에 사용
  - 혼합적 방식 : 상황에 따라 경쟁적 중재 방식과 협력적 중재 방식 사용

반응형 시스템
- 반응형 패러다임을 따르는 시스템
- 중재 방식
  - 경쟁적 중재 방식인 **포섭 구조**
  - 협력적 중재 방식인 **전위장**


포섭구조 
- 행위 모듈을 계층적인 구조로 구성

전위장(potential field) 방법
- 로봇이 위치하는 2차원 공간을 일정 크기의 그리드로 분할하여 표현
- 로봇의 이동에 관련된 행위별로 그리드의 각 셀(cell)에서의 이동 벡터 계산
- 각 셀에 대해서 행위별로 계산된 이동 벡터를 더하여 최종 이동 벡터를 결정

## 혼합형 패러다임

> 우선 계획수립을 해 놓은 다음에 이를 이용하여 반응형 패러다임처럼 로봇 동작

- 계획 모듈
  - 태스크를 완수할 수 있는 부분 태스크들로 분해하는 임무 계획수립을 한 다음, 각 부분 태스크를 수행할 행위를 결정
- 로봇
  - 실행 가능한 행위들이 중재를 통해서 병렬 수행

<img width="600" alt="image" src="https://user-images.githubusercontent.com/32366711/144772652-d43e9076-bb4e-4b26-ade8-dd7b765d3329.png">


# 로봇 제어 코드 구현

- 다양한 기능 모듈로 구성
- 개념적으로는 독립적으로 각각 기능
- 각 모듈이 소프트웨어적으로 병렬로 실행되고 있는 것처럼 각 모듈을 스레드(thread)로 구현
- 단일 프로세스를 사용하여 운영체제에서 시분할 처리하는 것처럼 모듈을 일정시간씩 돌아가면서 처리


# 로봇 소프트웨어 개발 프레임워크

- 배경
  - 로봇은 다양한 기능을 사용하여 서비스 구현
  - 다양한 신규 서비스 개발
  - 소프트웨어의 모듈화(modularization)와 재사용성(reusability) 관심
  - 소프트웨어 모듈간의 통신 문제
- 미들웨어(middleware) 
  - 소프트웨어 컴포넌트나 응용 프로그램이 쉽게 통신할 수 있도록 하는 소프트웨어
  - 로봇 소프트웨어 개발에 미들웨어를 제공하여 소프트웨어의 통신 기능 제공
- 개발 프레임워크(framework) 
  - 미들웨어 + 각종 개발 도구 + 라이브러리 제공
  - 로봇 소프트웨어 개발 생산성 향상
    - 기존 개발된 것을 최대한 사용하며 자신의 관심분야에 집중


## ROS

> 로봇 소프트웨어 개발 오픈소스 프레임워크
> 메시지 전달 기반의 통신 지원

- 노드(node) 
  - 실행 가능한 프로그램
  - ROS에서 최소 단위 실행 프로세스(process) 
- 토픽(topic) 
  - 노드간에 메시지를 교환하는 이름을 붙인 버스(named bus)
- 마스터(master) 
  - 노드 간의 연결 및 메시지 통신을 위한 네임서버(name server) 역할을 하는 노드
  - 노드들의 이름, 토픽과 서비스 등록
- 발행(publish)
  - 토픽의 내용을 해당 메시지 형태의 데이터로 전송하는 것
- 발행자(publisher) 
  - 발행하기 위해 토픽과 자신의 정보를 마스터에 등록하는 노드
  - 구독자 노드에 메시지 전송
- 구독(subscribe)
  - 토픽의 내용을 정해진 메시지 형태의 데이터로 수신하는 것
- 구독자(subscriber) 
  - 구독하기 위해 토픽 및 자신의 정보를 마스터에 등록하는 노드
  - 발행자 정보를 마스터로 부터 수신
  - 발행자 노드와 직접 접속하여 메시지 수신
    - 소켓 통신 이용

<img width="400" alt="image" src="https://user-images.githubusercontent.com/32366711/144773065-223cecf1-9c25-4779-a936-4cf628ca3501.png">

<img width="400" alt="image" src="https://user-images.githubusercontent.com/32366711/144773213-b786ec90-76a6-49c8-b04c-c49cfae9ea79.png">


# 로봇 계획수립

- 움직임 계획수립(motion planning)
  - 로봇이 원하는 움직임 작업을 수행할 수 있도록, 움직임에 관련된 제약 조건을 만족하게 하면서 평가 기준을 최적화하는 일련의 이산적인 움직임들을 찾는 것
- 경로 계획수립(path planning)
  - 주어진 시작 위치에서 목표 위치로 가기 위한 관절 공간이나 이동 공간내에서의 시간적 순서에 따른 위치들을 찾는 것
- 궤적 계획수립(trajectory planning)
  - 주어진 경로와 제약조건 및 로봇의 기계적인 특성을 고려하여 매 시점의 관절 또는 바퀴의 위치, 속도, 가속도 등의 값을 결정하는 것


# 동시적 위치추정 및 지도작성 SLAM

> 로봇이 알려지지 않은 정적인 환경(unknown, static environment)을 이동하면서 지도를 함께 작성하는 것

## 지도 작성

점유 격자 지도
- 공간을 격자(grid)로 표현
- 각 격자가 장애물에 의해 점유되었는지 여부의 확률 추정
- 로봇의 위치는 안다고 가정

## 위치 추정

- 지도가 없는 상태 또는 지도가 만들어지고 있는 상태에서 위치 추정
- 추측 항법(dead reckoning)
  - 바퀴의 회전량을 사용하여 상대적인 위치를 추정하는 방법
  - 엔코더 사용
  - 관성 센서 등을 사용 정확도 보완

## Kalman Filter 

- 시간에 따른 관측 데이터를 사용하여 미지의 변수(unknown variable)의 추정치를 구하는 알고리즘
- 잡음(Noise)을 가우시안(Gaussian) 함수로 표현


#### Extended Kalman Filter (EKF)
- 상태 변화 및 관측값이 선형함수(linear function)으로 표현되지 않고, 비선형 함수로 표현되는 경우 적용
- 부분적으로 선형화하여 처리

#### Unscented Kalman Filter (UKF) 
- EKF에 대한 근사적인 방법

## 파티클 필터(Particle Filter) 
- 로봇의 위치를 표본(파티클)들의 분포로 표현

1. 파티클 이동
- 각 파티클을 동적 시스템 방정식을 이용해서 이동
2. 확률 계산
- 주어진 지도 및 상황에서 해당 위치가 참일 확률 계산
3. 재 표본 추출
- 계산된 확률에 따라 파티클을 다시 표본 추출하여 파티클 집합 구성

# 항법

> 로봇이 정해진 목적지로 이동하는 것

### 항법을 위한 필요 요소

- 지도 : 정밀지도
  - LDM(Local Dynamic Map) : 정적/동적 정보를 저장하는 주행 정보 지도
- 로봇의 위치 계측 및 추정하는 기능
- 벽, 물체 등의 장애물을 계측하는 기능
- 목적지까지의 최적 경로를 계산하고 주행하는 기술

### 항법에서의 위치 추정

- 지도가 주어진 상태에서 센서 데이터를 참고하여 로봇의 위치를 결정
- 아이콘 기반 위치 추정 기법(Iconic localization method) 
  - 센서 관측정보를 직접 지도에 대조하여 위치 결정
- 특징기반 위치 추정 기법(Feature-based localization method) 
  - 코너(corner), 랜드마크(landmark) 등의 특징을 추출하여 위치 결정
- 확률적 위치 추정 기법(Probabilistic localization method) 
  - 확률 분포를 이용하여 장소에 대한 분포 정보수신
  - Kalman 필터, 파티클 필터 

# 자율주행

## 자율주행의 핵심요소

- 인식(perception)
  - 주변환경과 장애물 인식
- 위치추정(localization)
  - 환경 내에서 차량의 위치 추정 (cm 단위의 정확도 요구)
- 계획수립(planning)
  - 인식 내용 및 추정 위치를 토대로 원하는 위치로 이동을 위한 궤적 생성
- 제어(control)
  - 궤적을 따라 이동하기 위해 조향 및 가속정보 생성

## 자율주행 인식 문제

### 센서 융합

- 여러 센서의 데이터를 결합하여 정확도 높은 추정을 하는 것
- 완벽한 센서의 부재

<img width="215" alt="image" src="https://user-images.githubusercontent.com/32366711/145715303-7b08e574-f0c6-4788-902e-c50e15f13438.png">

## 위치 추정

- 환경 내에서 차량 자신의 위치 추정
- 위치추정 설정
  - 지도와 시작위치 제공 상황
  - 지도 제공 + 시작위치 미제공 상황
  - 지도와 시작위치 미제공 상황
    - Simultaneous Localization And Mapping (SLAM)

#### Visual Odometry (Frontend)

- 카메라 이미지를 분석하여 로봇의 위치와 방향 결정
- 인접한 이미지 사이의 카메라 움직임 계산
- 카메라 동작에 대한 정량적인 측정 필요
  - 회전 및 이동
- 카메라와 3차원 공간 점 사이의 기하학적 관계 이해 필요
- Drift error 발생
  - Visual odometry 만을 이용하여 궤적을 추정하면 오차 누적

해결책
- Backend optimization과 loop closure detection 필요
  - 현재 위치가 이전에 방문한 곳인지 판단

#### GraphSLAM

- Front-end : 센서 입력으로 받아 Pose Graph 생성
- Back-end : Front-end의 시간 경과에 따른 누적된 오류 최소화(Pose Graph Optimization (PGO))

Pose Graph Optimization (PGO)
- 오차가 최소화 되도록 모든 노드들의 위치를 최적화하는 과정

## 계획수립

- 상위/전역(high-level/global) 계획수립
  - 출발지에서 목적지로의 길(route) 결정
- 행동(behavioral) 계획수립
  - 타 차량, 보행자 등 장애물이 어떤 행동을 할질 예측하고, 의사결정을 하는 것
- 경로/지역(path/local) 계획 수립
  - 장애물을 회피한 궤적(trajectory) 생

### 상위/전역(high-level/global) 계획수립

- 그래프 탐색 알고리즘 적용 가능
  - A*, Dijkstra, DFS, BFS, … 
- 확률적(probabilistic) 계획수립
  - 강화학습 적용

### 행동(behavioral) 계획수립

- 의도 예측 (intention prediction) 
  - 객체 추적(tracking) : Hungarian Algorithm, 다중 객체 추적
    - 프레임 간 경계상자 매칭
  - 타 객체의 이동 예측
    - Kalman 필터 적용
- 의사결정
  - 상황에 따른 행동 규칙 직접 제공 (Finite State Machine) 
  - 강화학습을 통한 정책 학습

### 경로/지역(path/local) 계획 수립

- 장애물을 회피한 궤적(trajectory) 생성
- Rapidly-exploring Random Trees (RRT), RRT*, Probabilistic RoadMaps (PRM), PRM*, …

## 제어

> 궤적을 따라 이동하기 위해 조향 및 가속정보 생성

종단간(end-to-end) 주행 학습
- 인식단계 등이 없이 입력 영상 등으로 부터 주행 제어
- 강화학습 적용 사례


